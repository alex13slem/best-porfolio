---
import type { OpenGraphProps } from '@/types/open-graph';
import OpenGraph from './open-graph.astro';
import { getMainInfo } from '../lib/drizzle/queries/main-info';

interface Props extends Omit<OpenGraphProps, 'siteName'> {
  keywords?: string;
}

const { keywords, description: _description, title, ...props } = Astro.props;

const siteNameEnv = import.meta.env.SITE_NAME_TAB;
const mainInfoData = (await getMainInfo()).at(0);

const siteName = siteNameEnv || mainInfoData?.siteName || '';
const description = _description || mainInfoData?.siteDescription || '';
---

<>
  {keywords && <meta name="keywords" content={keywords} />}
  <meta name="description" content={description} />
  <OpenGraph {description} {title} {siteName} {...props} />

  <title>{siteName} | {title}</title>
</>
